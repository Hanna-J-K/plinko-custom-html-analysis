# WHAT IS IT
This is a custom validation code, using `cheerio.js` for parsing HTML and `xlsx` package for creating the validation report in excel.
It will create a *PageResults.xlsx* file with the results.

# HOW TO USE THE SCRIPT
  1. Paste all your links inside the `urls` const in an `urls.js` file.
   The file should be on the same level as `index.js` and `methods.js`.
   Example of the `urls` array:
   ```javascript
   export const urls = [
    "http://deloitte.com/first-page.html",
    "http://deloitte.com/second-page.html",
    "http://deloitte.com/third-page.html",
   ]
   ```
  
  2. Make sure the *PageResults.xlsx* file is closed.
  
  3. To run the script, use `npm start`.
  
   Remember it will automatically overwrite any and all content inside the *PageResults.xlsx* file.
   Results from parsing each link will show up in separate Excel worksheets (tabs).
  
  4. If this is your first time, copy the code provided in the `excel-formatting.ts` file to the Excel scripts (AUTOMATE > NEW SCRIPT)
   It's a script used to prepare the proper formatting of the Excel report.
   Remember you need to be logged into your work account (or other account which allows for automation scripts in MS Office products.)
  
  5. Use the Excel formatting script to format all the worksheets.

# ADDITIONAL NOTES
If you do not have access to one of the links (due to cookies, or VPN, or other missing permissions), you have to:

  * copy the entire content fragment (HTML `div`, usually with the id `html-fragment-content`)
  * paste it into an `html` file (e.g. `fragment.html`)
  * run the server locally (for instance, using the Live Server VSCode extension).
  * in the urls list, just paste the localhost link (e.g. `http://127.0.0.1:5500/fragment.html`)

# NEXT STEPS
Once the Excel validation report is created, you have to generate all other required reports.

There are 5 reports in total:
 * PLINKO custom validation report (the Excel file, includes links to all other reports)
 * Google Lighthouse report (PDF generated by the extension)
 * DevAxe report (screenshot of the results generated by the extension)
 * WAVE report (screenshot of the results generated by the extension)
 * W3C NU report (PDF of the results (printed from the results site) generated by the extension)

The name convention for all the reports is as follows:
`[ID from the spreadsheet]-[Page Title Or Name] [GEO-language] [report type] report.[extension]`

So, an example for all the reports respectively:
`27-Green Room Podcasts UK-en PLINKO validation report.xlsx`
`27-Green Room Podcasts UK-en Google Lighthouse report.pdf`
`27-Green Room Podcasts UK-en DevAxe report.png`
`27-Green Room Podcasts UK-en WAVE report.png`
`27-Green Room Podcasts UK-en W3C NU report.pdf`

## GENERATING REPORTS

### Google Lighthouse
  1. Install the Google Lighthouse extension for Chrome.
  2. Run the analysis.
  3. Save the **extended** report as PDF

### DevAxe
  1. Install the DevAxe extension for Chrome.
  2. Run the analysis.
  3. Save a screenshot of the results.

### WAVE
  1. Install the WAVE extension for Chrome.
  2. Run the analysis.
  3. Save general results **and** errors result into one screenshot.

### W3C NU
  1. Install the W3C extension for chrome.
  2. Paste the HTML content fragment into input box.
  3. Uncheck any unnecessary warnings or errors that do not apply.
  4. Remove unnecessary HTML elements (leave only errors).
  5. Print site and save results to PDF.

## UPLOADING AND LINKING REPORTS
  1. Upload all reports except for PLINKO to an appropriate directory (you may need to create one) in SharePoint.
   The name of the directory is usually `[ID from the spreadsheet]-[Page Title Or Name] [GEO-language]`, for instance `27-Green Room Podcasts UK-en`
  2. Copy links from the uploaded reports into the PLINKO Excel report.
   If any report returned 0 errors, mark it as *PASS*, otherwise as *FAIL*
  3. Fill out missing information:
   * If using a localhost URL, switch it for the link to the site
   * Add information on single content fragment or multiple content fragments
   * Save each page (each worksheet) to a separate Excel file, as they are separate reports.
  4. Upload the PLINKO validation report to the same directory as all others
  5. Link the directory in the Custom HTML spreadsheet.